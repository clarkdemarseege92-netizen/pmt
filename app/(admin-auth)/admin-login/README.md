# ç®¡ç†å‘˜ç™»å½•é¡µé¢

## è®¿é—®åœ°å€

```
/admin-login
```

> **æ³¨æ„**ï¼šç™»å½•è·¯å¾„å·²ä» `/admin/login` æ›´æ”¹ä¸º `/admin-login`ï¼Œä»¥é¿å…ä¸ç®¡ç†åå°çš„ layout é‡å®šå‘å†²çªã€‚

## åŠŸèƒ½è¯´æ˜

è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç®¡ç†å‘˜ä¸“ç”¨ç™»å½•é¡µé¢ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

### ç‰¹æ€§

- âœ… **ç‹¬ç«‹è®¿é—®è·¯å¾„**ï¼šä½¿ç”¨è·¯ç”±åˆ†ç»„ `(admin-auth)` éš”ç¦»ï¼Œä¸å— admin layout å½±å“
- ğŸ”’ **æƒé™éªŒè¯**ï¼šåªæœ‰æ‹¥æœ‰ç®¡ç†å‘˜æƒé™ï¼ˆ`role = 'admin'`ï¼‰çš„ç”¨æˆ·æ‰èƒ½ç™»å½•
- ğŸ¨ **ç¾è§‚ç•Œé¢**ï¼šä½¿ç”¨ DaisyUI è®¾è®¡çš„ç°ä»£åŒ–ç™»å½•ç•Œé¢
- ğŸ” **Google OAuth ç™»å½•**ï¼šä½¿ç”¨ Google è´¦å·å®‰å…¨ç™»å½•
- âš¡ **è‡ªåŠ¨é‡å®šå‘**ï¼š
  - å·²ç™»å½•çš„ç®¡ç†å‘˜ â†’ è‡ªåŠ¨è·³è½¬åˆ° `/admin`
  - å·²ç™»å½•ä½†éç®¡ç†å‘˜ â†’ è‡ªåŠ¨è·³è½¬åˆ° `/` å¹¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
  - æœªç™»å½•ç”¨æˆ·è®¿é—®åå° â†’ è‡ªåŠ¨è·³è½¬åˆ° `/admin-login`

### æŠ€æœ¯å®ç°

ä½¿ç”¨ Next.js çš„è·¯ç”±åˆ†ç»„ `(admin-auth)` æ¥åˆ›å»ºä¸å—çˆ¶ layout å½±å“çš„ç‹¬ç«‹é¡µé¢ï¼š

```
app/
â”œâ”€â”€ (admin-auth)/          # è·¯ç”±åˆ†ç»„ï¼ˆURLä¸­ä¸æ˜¾ç¤ºï¼‰
â”‚   â””â”€â”€ admin-login/       # å®é™…è®¿é—®è·¯å¾„ï¼š/admin-login
â”‚       â”œâ”€â”€ page.tsx
â”‚       â”œâ”€â”€ AdminLoginForm.tsx
â”‚       â””â”€â”€ README.md
â””â”€â”€ admin/                 # å— admin layout ä¿æŠ¤
    â”œâ”€â”€ layout.tsx         # ä¼šæ£€æŸ¥ç™»å½•å’Œæƒé™
    â”œâ”€â”€ page.tsx
    â””â”€â”€ categories/
```

## è®¾ç½®ç®¡ç†å‘˜è´¦æˆ·

### æ­¥éª¤ 1: é…ç½® Google OAuth

åœ¨ Supabase Dashboard ä¸­é…ç½® Google OAuthï¼š

1. è¿›å…¥ Supabase Dashboard â†’ Authentication â†’ Providers
2. å¯ç”¨ Google æä¾›å•†
3. å¡«å…¥ Google OAuth å‡­æ®ï¼ˆClient ID å’Œ Client Secretï¼‰
4. ä¿å­˜è®¾ç½®

### æ­¥éª¤ 2: é¦–æ¬¡ç™»å½•

1. è®¿é—® `http://localhost:3000/admin-login`
2. ç‚¹å‡»"ä½¿ç”¨ Google è´¦å·ç™»å½•"
3. é€‰æ‹©ä½ çš„ Google è´¦æˆ·
4. é¦–æ¬¡ç™»å½•ä¼šæç¤º"æ‚¨æ²¡æœ‰ç®¡ç†å‘˜æƒé™"

### æ­¥éª¤ 3: æˆäºˆç®¡ç†å‘˜æƒé™

åœ¨ Supabase SQL Editor ä¸­æ‰§è¡Œï¼š

```sql
-- é€šè¿‡é‚®ç®±è®¾ç½®ç®¡ç†å‘˜æƒé™
UPDATE profiles
SET role = 'admin'
WHERE id = (
  SELECT id FROM auth.users WHERE email = 'your-google-email@gmail.com'
);

-- éªŒè¯è®¾ç½®æˆåŠŸ
SELECT u.email, p.role
FROM auth.users u
JOIN profiles p ON p.id = u.id
WHERE p.role = 'admin';
```

### æ­¥éª¤ 4: é‡æ–°ç™»å½•

1. å†æ¬¡è®¿é—® `http://localhost:3000/admin-login`
2. ç‚¹å‡»"ä½¿ç”¨ Google è´¦å·ç™»å½•"
3. éªŒè¯é€šè¿‡åè‡ªåŠ¨è·³è½¬åˆ° `/admin`

## é”™è¯¯å¤„ç†

| é”™è¯¯ä¿¡æ¯ | è§£å†³æ–¹æ¡ˆ |
|---------|---------|
| "æ‚¨æ²¡æœ‰ç®¡ç†å‘˜æƒé™ï¼Œæ— æ³•è®¿é—®ç®¡ç†åå°" | æ‰§è¡ŒSQLè®¾ç½® role = 'admin' |
| "Google ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•" | æ£€æŸ¥ Supabase Google OAuth é…ç½® |
| "ç™»å½•éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•" | æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡è¯• |

## è®¤è¯æµç¨‹

1. **ç”¨æˆ·ç‚¹å‡»ç™»å½•** â†’ è°ƒç”¨ `supabase.auth.signInWithOAuth({ provider: 'google' })`
2. **é‡å®šå‘åˆ° Google** â†’ ç”¨æˆ·åœ¨ Google é¡µé¢æˆæƒ
3. **Google å›è°ƒ** â†’ è¿”å›åˆ° `/auth/callback?code=xxx&next=/admin`
4. **éªŒè¯æƒé™** â†’ æ£€æŸ¥ç”¨æˆ·çš„ `role` æ˜¯å¦ä¸º `admin`
5. **å®Œæˆç™»å½•** â†’ é‡å®šå‘åˆ° `/admin` æˆ–æ˜¾ç¤ºé”™è¯¯

## API ç«¯ç‚¹

- GET `/auth/callback` - OAuth å›è°ƒå¤„ç†ï¼ˆåŒ…å«ç®¡ç†å‘˜æƒé™éªŒè¯ï¼‰
- POST `/api/admin/logout` - é€€å‡ºç™»å½•

## æ–‡ä»¶ç»“æ„

```
app/(admin-auth)/admin-login/
â”œâ”€â”€ page.tsx              # æœåŠ¡ç«¯éªŒè¯é¡µé¢
â”œâ”€â”€ AdminLoginForm.tsx    # å®¢æˆ·ç«¯ç™»å½•è¡¨å•
â””â”€â”€ README.md             # æœ¬æ–‡æ¡£
```

## æ³¨æ„äº‹é¡¹

- âš ï¸ ç™»å½•è·¯å¾„ä¸º `/admin-login`ï¼ˆå¸¦è¿å­—ç¬¦ï¼‰
- âš ï¸ ä¸æ˜¯ `/admin/login`ï¼ˆè¿™ä¼šå¯¼è‡´é‡å®šå‘å¾ªç¯ï¼‰
- âœ… ä½¿ç”¨è·¯ç”±åˆ†ç»„ `(admin-auth)` é¿å… layout å†²çª
